!function(a){function l(a){var c=f;return b.methods.forEach(function(b){Array.isArray(b)&&b[0]==a&&(c=b[1])}),c}function n(a,b){var c={csp:!1,unwrapPromises:!1,logPromiseWarnings:!0},d=new m.Lexer(c),e=new m.Parser(d,l,c);return e.parse(a,!1)(b)}var b={},c=Array.prototype.slice,e=(Array.prototype.concat,/\{\{(.+?)\}\}/g),f=function(){},i=/(<%\s*((if)|(for))\s*\((.+?)\)\s*\{\s*%>)|(<%\s*}\s*%>)/g,j=/\s*(.+)\s*in\s*(.+)\s*/g;!function(a){function h(a,b){if("constructor"===a)throw g("isecfld",'Referencing "constructor" field in Angular expressions is disallowed! Expression: {0}',b);return a}function i(a,b){if(a){if(a.constructor===a)throw g("isecfn","Referencing Function in Angular expressions is disallowed! Expression: {0}",b);if(a.document&&a.location&&a.alert&&a.setInterval)throw g("isecwindow","Referencing the Window in Angular expressions is disallowed! Expression: {0}",b);if(a.children&&(a.nodeName||a.on&&a.find))throw g("isecdom","Referencing DOM nodes in Angular expressions is disallowed! Expression: {0}",b)}return a}function n(a,b,c,d,e){e=e||{};for(var g,f=b.split("."),i=0;f.length>1;i++){g=h(f.shift(),d);var j=a[g];j||(j={},a[g]=j),a=j,a.then&&e.unwrapPromises&&(promiseWarning(d),"$$v"in a||function(a){a.then(function(b){a.$$v=b})}(a),void 0===a.$$v&&(a.$$v={}),a=a.$$v)}return g=h(f.shift(),d),a[g]=c,c}function p(a,b,c,d,e,f,g){return h(a,f),h(b,f),h(c,f),h(d,f),h(e,f),g.unwrapPromises?function(g,h){var j,i=h&&h.hasOwnProperty(a)?h:g;return null==i?i:(i=i[a],i&&i.then&&(promiseWarning(f),"$$v"in i||(j=i,j.$$v=void 0,j.then(function(a){j.$$v=a})),i=i.$$v),null==i?b?void 0:i:(i=i[b],i&&i.then&&(promiseWarning(f),"$$v"in i||(j=i,j.$$v=void 0,j.then(function(a){j.$$v=a})),i=i.$$v),null==i?c?void 0:i:(i=i[c],i&&i.then&&(promiseWarning(f),"$$v"in i||(j=i,j.$$v=void 0,j.then(function(a){j.$$v=a})),i=i.$$v),null==i?d?void 0:i:(i=i[d],i&&i.then&&(promiseWarning(f),"$$v"in i||(j=i,j.$$v=void 0,j.then(function(a){j.$$v=a})),i=i.$$v),null==i?e?void 0:i:(i=i[e],i&&i.then&&(promiseWarning(f),"$$v"in i||(j=i,j.$$v=void 0,j.then(function(a){j.$$v=a})),i=i.$$v),i)))))}:function(f,g){var h=g&&g.hasOwnProperty(a)?g:f;return null==h?h:(h=h[a],null==h?b?void 0:h:(h=h[b],null==h?c?void 0:h:(h=h[c],null==h?d?void 0:h:(h=h[d],null==h?e?void 0:h:h=h[e]))))}}function q(a,b){return h(a,b),function(b,c){return null==b?void 0:(c&&c.hasOwnProperty(a)?c:b)[a]}}function r(a,b,c){return h(a,c),h(b,c),function(c,d){return null==c?void 0:(c=(d&&d.hasOwnProperty(a)?d:c)[a],null==c?void 0:c[b])}}function s(a,b,c){if(o.hasOwnProperty(a))return o[a];var f,d=a.split("."),e=d.length;if(b.unwrapPromises||1!==e)if(b.unwrapPromises||2!==e)if(b.csp)f=6>e?p(d[0],d[1],d[2],d[3],d[4],c,b):function(a,f){var h,g=0;do h=p(d[g++],d[g++],d[g++],d[g++],d[g++],c,b)(a,f),f=void 0,a=h;while(e>g);return h};else{var g="var p;\n";forEach(d,function(a,d){h(a,c),g+="if(s == null) return undefined;\ns="+(d?"s":'((k&&k.hasOwnProperty("'+a+'"))?k:s)')+'["'+a+'"]'+";\n"+(b.unwrapPromises?'if (s && s.then) {\n pw("'+c.replace(/(["\r\n])/g,"\\$1")+'");\n'+' if (!("$$v" in s)) {\n'+" p=s;\n"+" p.$$v = undefined;\n"+" p.then(function(v) {p.$$v=v;});\n"+"}\n"+" s=s.$$v\n"+"}\n":"")}),g+="return s;";var i=new Function("s","k","pw",g);i.toString=valueFn(g),f=b.unwrapPromises?function(a,b){return i(a,b,promiseWarning)}:i}else f=r(d[0],d[1],c);else f=q(d[0],c);return"hasOwnProperty"!==a&&(o[a]=f),f}var b=function(){},d=function(a,b){for(var c in b)a[c]=b[c];return a},e=function(a){return"undefined"==typeof a?!1:!0},f=function(a){return a.toLowerCase()},g=function(){var a=[];a.push(arguments[0]+"\r\n");var b=arguments[1],d=c.call(arguments,0).slice(2),e={};b.replace(/\{(\d+)\}/g,function(a,b){e[a]=d[+b].toString()});for(var f in e)b=b.replace(f,e[f]);return a.push(b),new Error(a.join(""))},j={"null":function(){return null},"true":function(){return!0},"false":function(){return!1},undefined:b,"+":function(a,b,c,d){return c=c(a,b),d=d(a,b),e(c)?e(d)?c+d:c:e(d)?d:void 0},"-":function(a,b,c,d){return c=c(a,b),d=d(a,b),(e(c)?c:0)-(e(d)?d:0)},"*":function(a,b,c,d){return c(a,b)*d(a,b)},"/":function(a,b,c,d){return c(a,b)/d(a,b)},"%":function(a,b,c,d){return c(a,b)%d(a,b)},"^":function(a,b,c,d){return c(a,b)^d(a,b)},"=":b,"===":function(a,b,c,d){return c(a,b)===d(a,b)},"!==":function(a,b,c,d){return c(a,b)!==d(a,b)},"==":function(a,b,c,d){return c(a,b)==d(a,b)},"!=":function(a,b,c,d){return c(a,b)!=d(a,b)},"<":function(a,b,c,d){return c(a,b)<d(a,b)},">":function(a,b,c,d){return c(a,b)>d(a,b)},"<=":function(a,b,c,d){return c(a,b)<=d(a,b)},">=":function(a,b,c,d){return c(a,b)>=d(a,b)},"&&":function(a,b,c,d){return c(a,b)&&d(a,b)},"||":function(a,b,c,d){return c(a,b)||d(a,b)},"&":function(a,b,c,d){return c(a,b)&d(a,b)},"|":function(a,b,c,d){return d(a,b)(a,b,c(a,b))},"!":function(a,b,c){return!c(a,b)}},k={n:"\n",f:"\f",r:"\r",t:"	",v:"","'":"'",'"':'"'},l=function(a){this.options=a};l.prototype={constructor:l,lex:function(a){this.text=a,this.index=0,this.ch=void 0,this.lastCh=":",this.tokens=[];for(var b,c=[];this.index<this.text.length;){if(this.ch=this.text.charAt(this.index),this.is("\"'"))this.readString(this.ch);else if(this.isNumber(this.ch)||this.is(".")&&this.isNumber(this.peek()))this.readNumber();else if(this.isIdent(this.ch))this.readIdent(),this.was("{,")&&"{"===c[0]&&(b=this.tokens[this.tokens.length-1])&&(b.json=-1===b.text.indexOf("."));else if(this.is("(){}[].,;:?"))this.tokens.push({index:this.index,text:this.ch,json:this.was(":[,")&&this.is("{[")||this.is("}]:,")}),this.is("{[")&&c.unshift(this.ch),this.is("}]")&&c.shift(),this.index++;else{if(this.isWhitespace(this.ch)){this.index++;continue}var d=this.ch+this.peek(),e=d+this.peek(2),f=j[this.ch],g=j[d],h=j[e];h?(this.tokens.push({index:this.index,text:e,fn:h}),this.index+=3):g?(this.tokens.push({index:this.index,text:d,fn:g}),this.index+=2):f?(this.tokens.push({index:this.index,text:this.ch,fn:f,json:this.was("[,:")&&this.is("+-")}),this.index+=1):this.throwError("Unexpected next character ",this.index,this.index+1)}this.lastCh=this.ch}return this.tokens},is:function(a){return-1!==a.indexOf(this.ch)},was:function(a){return-1!==a.indexOf(this.lastCh)},peek:function(a){var b=a||1;return this.index+b<this.text.length?this.text.charAt(this.index+b):!1},isNumber:function(a){return a>="0"&&"9">=a},isWhitespace:function(a){return" "===a||"\r"===a||"	"===a||"\n"===a||""===a||"\xa0"===a},isIdent:function(a){return a>="a"&&"z">=a||a>="A"&&"Z">=a||"_"===a||"$"===a},isExpOperator:function(a){return"-"===a||"+"===a||this.isNumber(a)},throwError:function(a,b,c){c=c||this.index;var d=e(b)?"s "+b+"-"+this.index+" ["+this.text.substring(b,c)+"]":" "+c;throw g("lexerr","Lexer Error: {0} at column{1} in expression [{2}].",a,d,this.text)},readNumber:function(){for(var a="",b=this.index;this.index<this.text.length;){var c=f(this.text.charAt(this.index));if("."==c||this.isNumber(c))a+=c;else{var d=this.peek();if("e"==c&&this.isExpOperator(d))a+=c;else if(this.isExpOperator(c)&&d&&this.isNumber(d)&&"e"==a.charAt(a.length-1))a+=c;else{if(!this.isExpOperator(c)||d&&this.isNumber(d)||"e"!=a.charAt(a.length-1))break;this.throwError("Invalid exponent")}}this.index++}a=1*a,this.tokens.push({index:b,text:a,json:!0,fn:function(){return a}})},readIdent:function(){for(var e,f,g,h,a=this,b="",c=this.index;this.index<this.text.length&&(h=this.text.charAt(this.index),"."===h||this.isIdent(h)||this.isNumber(h));)"."===h&&(e=this.index),b+=h,this.index++;if(e)for(f=this.index;f<this.text.length;){if(h=this.text.charAt(f),"("===h){g=b.substr(e-c+1),b=b.substr(0,e-c),this.index=f;break}if(!this.isWhitespace(h))break;f++}var i={index:c,text:b};if(j.hasOwnProperty(b))i.fn=j[b],i.json=j[b];else{var k=s(b,this.options,this.text);i.fn=d(function(a,b){return k(a,b)},{assign:function(c,d){return n(c,b,d,a.text,a.options)}})}this.tokens.push(i),g&&(this.tokens.push({index:e,text:".",json:!1}),this.tokens.push({index:e+1,text:g,json:!1}))},readString:function(a){var b=this.index;this.index++;for(var c="",d=a,e=!1;this.index<this.text.length;){var f=this.text.charAt(this.index);if(d+=f,e){if("u"===f){var g=this.text.substring(this.index+1,this.index+5);g.match(/[\da-f]{4}/i)||this.throwError("Invalid unicode escape [\\u"+g+"]"),this.index+=4,c+=String.fromCharCode(parseInt(g,16))}else{var h=k[f];c+=h?h:f}e=!1}else if("\\"===f)e=!0;else{if(f===a)return this.index++,this.tokens.push({index:b,text:d,string:c,json:!0,fn:function(){return c}}),void 0;c+=f}this.index++}this.throwError("Unterminated quote",b)}};var m=function(a,b,c){this.lexer=a,this.$filter=b,this.options=c};m.ZERO=function(){return 0},m.prototype={constructor:m,parse:function(a,b){this.text=a,this.json=b,this.tokens=this.lexer.lex(a),b&&(this.assignment=this.logicalOR,this.functionCall=this.fieldAccess=this.objectIndex=this.filterChain=function(){this.throwError("is not valid json",{text:a,index:0})});var c=b?this.primary():this.statements();return 0!==this.tokens.length&&this.throwError("is an unexpected token",this.tokens[0]),c.literal=!!c.literal,c.constant=!!c.constant,c},primary:function(){var a;if(this.expect("("))a=this.filterChain(),this.consume(")");else if(this.expect("["))a=this.arrayDeclaration();else if(this.expect("{"))a=this.object();else{var b=this.expect();a=b.fn,a||this.throwError("not a primary expression",b),b.json&&(a.constant=!0,a.literal=!0)}for(var c,d;c=this.expect("(","[",".");)"("===c.text?(a=this.functionCall(a,d),d=null):"["===c.text?(d=a,a=this.objectIndex(a)):"."===c.text?(d=a,a=this.fieldAccess(a)):this.throwError("IMPOSSIBLE");return a},throwError:function(a,b){throw g("syntax","Syntax Error: Token '{0}' {1} at column {2} of the expression [{3}] starting at [{4}].",b.text,a,b.index+1,this.text,this.text.substring(b.index))},peekToken:function(){if(0===this.tokens.length)throw g("ueoe","Unexpected end of expression: {0}",this.text);return this.tokens[0]},peek:function(a,b,c,d){if(this.tokens.length>0){var e=this.tokens[0],f=e.text;if(f===a||f===b||f===c||f===d||!a&&!b&&!c&&!d)return e}return!1},expect:function(a,b,c,d){var e=this.peek(a,b,c,d);return e?(this.json&&!e.json&&this.throwError("is not valid json",e),this.tokens.shift(),e):!1},consume:function(a){this.expect(a)||this.throwError("is unexpected, expecting ["+a+"]",this.peek())},unaryFn:function(a,b){return d(function(c,d){return a(c,d,b)},{constant:b.constant})},ternaryFn:function(a,b,c){return d(function(d,e){return a(d,e)?b(d,e):c(d,e)},{constant:a.constant&&b.constant&&c.constant})},binaryFn:function(a,b,c){return d(function(d,e){return b(d,e,a,c)},{constant:a.constant&&c.constant})},statements:function(){for(var a=[];;)if(this.tokens.length>0&&!this.peek("}",")",";","]")&&a.push(this.filterChain()),!this.expect(";"))return 1===a.length?a[0]:function(b,c){for(var d,e=0;e<a.length;e++){var f=a[e];f&&(d=f(b,c))}return d}},filterChain:function(){for(var b,a=this.expression();;){if(!(b=this.expect("|")))return a;a=this.binaryFn(a,b.fn,this.filter())}},filter:function(){for(var a=this.expect(),b=this.$filter(a.text),c=[];;){if(!(a=this.expect(":"))){var d=function(a,d,e){for(var f=[e],g=0;g<c.length;g++)f.push(c[g](a,d));return b.apply(a,f)};return function(){return d}}c.push(this.expression())}},expression:function(){return this.assignment()},assignment:function(){var b,c,a=this.ternary();return(c=this.expect("="))?(a.assign||this.throwError("implies assignment but ["+this.text.substring(0,c.index)+"] can not be assigned to",c),b=this.ternary(),function(c,d){return a.assign(c,b(c,d),d)}):a},ternary:function(){var b,c,a=this.logicalOR();return(c=this.expect("?"))?(b=this.ternary(),(c=this.expect(":"))?this.ternaryFn(a,b,this.ternary()):(this.throwError("expected :",c),void 0)):a},logicalOR:function(){for(var b,a=this.logicalAND();;){if(!(b=this.expect("||")))return a;a=this.binaryFn(a,b.fn,this.logicalAND())}},logicalAND:function(){var b,a=this.equality();return(b=this.expect("&&"))&&(a=this.binaryFn(a,b.fn,this.logicalAND())),a},equality:function(){var b,a=this.relational();return(b=this.expect("==","!=","===","!=="))&&(a=this.binaryFn(a,b.fn,this.equality())),a},relational:function(){var b,a=this.additive();return(b=this.expect("<",">","<=",">="))&&(a=this.binaryFn(a,b.fn,this.relational())),a},additive:function(){for(var b,a=this.multiplicative();b=this.expect("+","-");)a=this.binaryFn(a,b.fn,this.multiplicative());return a},multiplicative:function(){for(var b,a=this.unary();b=this.expect("*","/","%");)a=this.binaryFn(a,b.fn,this.unary());return a},unary:function(){var a;return this.expect("+")?this.primary():(a=this.expect("-"))?this.binaryFn(m.ZERO,a.fn,this.unary()):(a=this.expect("!"))?this.unaryFn(a.fn,this.unary()):this.primary()},fieldAccess:function(a){var b=this,c=this.expect().text,e=s(c,this.options,this.text);return d(function(b,c,d){return e(d||a(b,c),c)},{assign:function(d,e,f){return n(a(d,f),c,e,b.text,b.options)}})},objectIndex:function(a){var b=this,c=this.expression();return this.consume("]"),d(function(d,e){var h,j,f=a(d,e),g=c(d,e);return f?(h=i(f[g],b.text),h&&h.then&&b.options.unwrapPromises&&(j=h,"$$v"in h||(j.$$v=void 0,j.then(function(a){j.$$v=a})),h=h.$$v),h):void 0},{assign:function(d,e,f){var g=c(d,f),h=i(a(d,f),b.text);return h[g]=e}})},functionCall:function(a,c){var d=[];if(")"!==this.peekToken().text)do d.push(this.expression());while(this.expect(","));this.consume(")");var e=this;return function(f,g){for(var h=[],j=c?c(f,g):f,k=0;k<d.length;k++)h.push(d[k](f,g));var l=a(f,g,j)||b;i(j,e.text),i(l,e.text);var m=l.apply?l.apply(j,h):l(h[0],h[1],h[2],h[3],h[4]);return i(m,e.text)}},arrayDeclaration:function(){var a=[],b=!0;if("]"!==this.peekToken().text)do{var c=this.expression();a.push(c),c.constant||(b=!1)}while(this.expect(","));return this.consume("]"),d(function(b,c){for(var d=[],e=0;e<a.length;e++)d.push(a[e](b,c));return d},{literal:!0,constant:b})},object:function(){var a=[],b=!0;if("}"!==this.peekToken().text)do{var c=this.expect(),e=c.string||c.text;this.consume(":");var f=this.expression();a.push({key:e,value:f}),f.constant||(b=!1)}while(this.expect(","));return this.consume("}"),d(function(b,c){for(var d={},e=0;e<a.length;e++){var f=a[e];d[f.key]=f.value(b,c)}return d},{literal:!0,constant:b})}};var o={};a.$parse={Lexer:l,Parser:m}}(b),b.methods=[];var m=b.$parse;return b.template=function(a,b){function d(){a=a.replace(/[\r\n]+/g,""),a="<% if(1) {%>"+a+"<% } %>";var d=f();k(d),a=a.replace(/\$[\d]+/g,""),a="var __context = this;var result = [];"+a+";return result.join('');";var e=new Function(a);return e.call(b)}function f(){var d,b={},c=0,e=!0,f=function(a){var c;for(var d in b)a?a>d&&(b[d].end||(c=b[d])):b[d].end||(c=b[d]);return c};return a=a.replace(i,function(a,g,i,k,l,m,n){if(g){if(d&&c++,e||d||c++,b[c]={id:c},0!=c){var q=f(c);q&&(q.childs=q.childs||[],q.childs.push(b[c]),b[c].parent=q)}else b[c].parent=null;b[c].value=m;var s,t,r="i"+c;return b[c].value.replace(j,function(a,b,c){s=String(b).trim(),t=String(c).trim()}),k?(b[c].type="if",b[c].parent&&b[c]==b[c].parent.childs[0]?(h(b[c])?g="if("+b[c].value+") { result.push('":(g='if(!!_.parse("'+b[c].value+"\",__context)) { result.push('",g="var __context = this ;"+g),g="');"+g):b[c].parent?h(b[c])||(g='if(!!_.parse("'+b[c].value+"\",__context)) { result.push('",g="var __context = this ;"+g):g='if(!!_.parse("'+b[c].value+"\",__context)) { result.push('",g="$"+c+g+"$"+c):l&&(b[c].type="for",b[c].key=s,b[c].args=t,g="for(var "+r+"=0;"+r+" < "+t+".length;"+r+"++) { "+"var "+s+" = "+t+"["+r+"];"+" var  __context = {};__context['"+s+"'] = "+t+"["+r+"];"+" result.push('",b[c].parent&&b[c]==b[c].parent.childs[0]?(h(b[c])||(g="var "+t+" = this."+t+";"+g),g="');"+g):h(b[c])||(g="var "+t+" = this."+t+";"+g),g="$"+c+g+"$"+c),b[c].start=g,d=!0,e=!1,g}if(n){d=!1,e=!1;var u=f(),v=u.id;return n=u.childs?" } ":" ');} ",n="$"+v+n+"$"+v,u.end=n,n}}),b}function g(b){var c="(\\$"+b.id+"\\s*[\\s\\S]+\\s*\\$"+b.id+")([\\s\\S]+)(\\$"+b.id+"\\s*[\\s\\S]+\\s*\\$"+b.id+")";a=a.replace(new RegExp(c,"g"),function(a,b,c,d){return c=c.replace(e,function(a,b){return b="' + _.parse('"+b+"',__context) + '"}),b+c+d})}function h(a){for(var b=a;;){if(b=b.parent,!b)return b;if("for"==b.type)return b}return b}function k(a){for(var c in a){var d=a[c].childs;d&&d.length&&k(d),g(a[c])}}return b?d(b):function(a){return d(a)}},b.parse=n,b.methods.push(["number",function(a){return Number(a)}]),"undefined"!=typeof define&&define("template",function(a,c,d){d.exports=b}),"undefined"!=typeof module&&"undefined"!=module.exports&&(module.exports=b),a.$template=b,b}(this);